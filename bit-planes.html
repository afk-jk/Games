<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pixel Planes – Mini Games Arcade</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --bg: #020617;
      --panel: #020617;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #38bdf8;
      --good: #22c55e;
      --danger: #f97316;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    html, body {
      height: 100%;
    }

    body {
      min-height: 100vh;
      margin: 0;
      background: radial-gradient(circle at top, #1f2937 0, #020617 55%);
      color: var(--text);
      display: flex;
      justify-content: center;
      padding: 10px;
      overflow-x: hidden;
      overflow-y: auto;
    }

    .page {
      width: 100%;
      max-width: 1200px;
      display: grid;
      grid-template-columns: 220px minmax(0, 1fr) 220px;
      gap: 10px;
      align-items: stretch;
    }

    @media (max-width: 960px) {
      .page {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .panel {
      background: radial-gradient(circle at top, #020617 0, #020617 70%);
      border-radius: 16px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.7);
      padding: 10px;
    }

    .ad-column {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .ad-slot {
      height: 140px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-radius: 14px;
      border: 2px dashed rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.9);
      color: var(--muted);
      text-align: center;
      padding: 6px;
      font-size: 0.78rem;
    }

    .ad-label {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .ad-size {
      font-size: 0.75rem;
      opacity: 0.9;
      margin-bottom: 2px;
    }

    /* MAIN CENTER PANEL */
    .main-panel {
      display: flex;
      flex-direction: column;
      gap: 8px;
      align-items: center;
    }

    .top-bar {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .back-link {
      text-decoration: none;
      font-size: 0.78rem;
      color: var(--muted);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.7);
      background: rgba(15, 23, 42, 0.8);
    }

    .back-link:hover {
      border-color: var(--accent);
      color: #f9fafb;
    }

    h1 {
      font-size: 1.7rem;
      letter-spacing: 0.06em;
    }

    .subtitle {
      font-size: 0.8rem;
      color: var(--muted);
      margin-bottom: 4px;
      width: 100%;
    }

    .game-container {
      width: 100%;
      max-width: 520px;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 4px;
    }

    .stat-pills {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .stat-pill {
      padding: 4px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.7);
      font-size: 0.78rem;
      display: inline-flex;
      align-items: baseline;
      gap: 4px;
    }

    .stat-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
    }

    .stat-value {
      font-weight: 600;
    }

    .btn {
      border: none;
      outline: none;
      padding: 5px 10px;
      border-radius: 999px;
      background: linear-gradient(135deg, #38bdf8, #1d4ed8);
      color: #f9fafb;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.78rem;
      box-shadow: 0 5px 14px rgba(37, 99, 235, 0.6);
      transition: transform 0.08s ease, box-shadow 0.08s ease;
      white-space: nowrap;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.8);
    }

    .btn:active {
      transform: translateY(0);
      box-shadow: 0 4px 10px rgba(15, 23, 42, 0.9);
    }

    .controls-text {
      font-size: 0.78rem;
      color: var(--muted);
      margin-bottom: 4px;
    }

    .controls-text span {
      background: rgba(15, 23, 42, 0.85);
      border-radius: 999px;
      padding: 2px 7px;
      margin-right: 4px;
      border: 1px solid rgba(148, 163, 184, 0.6);
    }

    .status-row {
      font-size: 0.78rem;
      color: var(--muted);
      margin-bottom: 4px;
      display: flex;
      justify-content: space-between;
      gap: 6px;
      flex-wrap: wrap;
    }

    .status-text {
      font-weight: 600;
    }

    .status-text.good {
      color: var(--good);
    }

    .status-text.bad {
      color: var(--danger);
    }

    .board-wrapper {
      width: 100%;
      max-width: 480px;
      margin: 0 auto;
      aspect-ratio: 3 / 4; /* vertical shooter */
      background: radial-gradient(circle at top, #020617 0, #000000 70%);
      border-radius: 10px;
      padding: 6px;
      box-shadow: 0 14px 0 #020617, 0 20px 32px rgba(0, 0, 0, 0.85);
      position: relative;
      overflow: hidden;
      user-select: none;
      touch-action: none;
    }

    canvas {
      width: 100%;
      height: 100%;
      display: block;
      border-radius: 8px;
      background: #020617;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- LEFT ADS -->
    <aside class="panel ad-column">
      <div class="ad-slot">
        <div class="ad-label">Ad Slot #1</div>
        <div class="ad-size">300 × 250</div>
        <div>Place a banner or script here.</div>
      </div>
      <div class="ad-slot">
        <div class="ad-label">Ad Slot #2</div>
        <div class="ad-size">160 × 600</div>
      </div>
    </aside>

    <!-- GAME -->
    <main class="panel main-panel">
      <div class="top-bar">
        <a class="back-link" href="index.html">← Back to games</a>
        <h1>Pixel Planes</h1>
      </div>
      <p class="subtitle">
        Bit-style vertical shooter: fly your tiny plane, dodge bullets and shoot enemy ships.
      </p>

      <div class="game-container">
        <div class="info-row">
          <div class="stat-pills">
            <div class="stat-pill">
              <span class="stat-label">Score</span>
              <span id="score" class="stat-value">0</span>
            </div>
            <div class="stat-pill">
              <span class="stat-label">Best</span>
              <span id="best" class="stat-value">0</span>
            </div>
            <div class="stat-pill">
              <span class="stat-label">Lives</span>
              <span id="lives" class="stat-value">3</span>
            </div>
          </div>
          <button id="restartBtn" class="btn">New Run</button>
        </div>

        <div class="controls-text">
          <span>Move: WASD / Arrow keys</span>
          <span>Shoot: Space / J / tap</span>
        </div>

        <div class="status-row">
          <span id="statusText" class="status-text"></span>
          <span>Tip: stay near the bottom to dodge, move up only to grab stars.</span>
        </div>

        <div class="board-wrapper" id="boardWrapper">
          <canvas id="gameCanvas" width="360" height="480"></canvas>
        </div>
      </div>
    </main>

    <!-- RIGHT ADS -->
    <aside class="panel ad-column">
      <div class="ad-slot">
        <div class="ad-label">Ad Slot #3</div>
        <div class="ad-size">300 × 250</div>
      </div>
      <div class="ad-slot">
        <div class="ad-label">Ad Slot #4</div>
        <div class="ad-size">Flexible</div>
      </div>
    </aside>
  </div>

  <script>
    (function () {
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");
      const scoreEl = document.getElementById("score");
      const bestEl = document.getElementById("best");
      const livesEl = document.getElementById("lives");
      const statusText = document.getElementById("statusText");
      const restartBtn = document.getElementById("restartBtn");
      const boardWrapper = document.getElementById("boardWrapper");

      const BEST_KEY = "pixelPlanesBest";

      const WIDTH = canvas.width;
      const HEIGHT = canvas.height;

      const keys = {
        left: false,
        right: false,
        up: false,
        down: false,
        shoot: false,
      };

      let player;
      let bullets;
      let enemies;
      let enemyBullets;
      let stars;
      let score = 0;
      let bestScore = Number(localStorage.getItem(BEST_KEY)) || 0;
      let lives = 3;
      let lastTime = 0;
      let shootCooldown = 0;
      let spawnCooldown = 0;
      let running = true;

      bestEl.textContent = bestScore;

      function resetGame() {
        player = {
          x: WIDTH / 2,
          y: HEIGHT - 60,
          w: 20,
          h: 20,
          speed: 220, // px per second
          invincibleTime: 0,
        };
        bullets = [];
        enemies = [];
        enemyBullets = [];
        stars = [];
        score = 0;
        lives = 3;
        running = true;
        shootCooldown = 0;
        spawnCooldown = 0;
        statusText.textContent = "";
        statusText.className = "status-text";
        scoreEl.textContent = "0";
        livesEl.textContent = lives.toString();
        lastTime = performance.now();
        requestAnimationFrame(loop);
      }

      function spawnEnemy() {
        const side = Math.random();
        const x = 30 + Math.random() * (WIDTH - 60);
        const speed = 55 + Math.random() * 40;
        enemies.push({
          x,
          y: -20,
          w: 20,
          h: 20,
          speed,
          shootTimer: 0,
        });
      }

      function spawnStar(x, y) {
        stars.push({
          x,
          y,
          r: 3 + Math.random() * 3,
          vy: 30 + Math.random() * 30,
        });
      }

      function update(dt) {
        if (!running) return;

        // Background star field (small)
        if (Math.random() < 0.6) {
          stars.push({
            x: Math.random() * WIDTH,
            y: -5,
            r: 1,
            vy: 40 + Math.random() * 40,
          });
        }

        stars.forEach(s => {
          s.y += s.vy * dt;
        });
        stars = stars.filter(s => s.y < HEIGHT + 10);

        // Player movement
        let dx = 0;
        let dy = 0;
        if (keys.left) dx -= 1;
        if (keys.right) dx += 1;
        if (keys.up) dy -= 1;
        if (keys.down) dy += 1;

        if (dx !== 0 || dy !== 0) {
          const len = Math.hypot(dx, dy) || 1;
          dx /= len; dy /= len;
          player.x += dx * player.speed * dt;
          player.y += dy * player.speed * dt;
        }

        // Clamp player
        const margin = 12;
        player.x = Math.max(player.w / 2 + margin, Math.min(WIDTH - player.w / 2 - margin, player.x));
        player.y = Math.max(player.h / 2 + margin, Math.min(HEIGHT - player.h / 2 - margin, player.y));

        // Shooting
        shootCooldown -= dt;
        if (keys.shoot && shootCooldown <= 0) {
          bullets.push({
            x: player.x,
            y: player.y - player.h / 2,
            vy: -320,
          });
          shootCooldown = 0.18;
        }

        bullets.forEach(b => {
          b.y += b.vy * dt;
        });
        bullets = bullets.filter(b => b.y > -20);

        // Enemies
        spawnCooldown -= dt;
        if (spawnCooldown <= 0) {
          spawnEnemy();
          spawnCooldown = Math.max(0.35, 1.2 - score / 200); // faster spawns over time
        }

        enemies.forEach(e => {
          e.y += e.speed * dt;
          e.shootTimer -= dt;
          if (e.shootTimer <= 0 && e.y > 40 && Math.random() < 0.4) {
            enemyBullets.push({
              x: e.x,
              y: e.y + e.h / 2,
              vy: 140 + Math.random() * 40,
            });
            e.shootTimer = 0.7 + Math.random() * 0.6;
          }
        });
        enemies = enemies.filter(e => e.y < HEIGHT + 40);

        enemyBullets.forEach(b => {
          b.y += b.vy * dt;
        });
        enemyBullets = enemyBullets.filter(b => b.y < HEIGHT + 20);

        // Collisions
        // bullets vs enemies
        bullets.forEach(b => {
          enemies.forEach(e => {
            if (rectHit(b.x - 3, b.y - 6, 6, 12, e.x - e.w / 2, e.y - e.h / 2, e.w, e.h)) {
              e.dead = true;
              b.dead = true;
              score += 10;
              scoreEl.textContent = score.toString();
              spawnStar(e.x, e.y);
            }
          });
        });
        bullets = bullets.filter(b => !b.dead);
        enemies = enemies.filter(e => !e.dead);

        // enemy bullets vs player
        if (player.invincibleTime > 0) {
          player.invincibleTime -= dt;
        } else {
          let hit = false;
          enemyBullets.forEach(b => {
            if (rectHit(b.x - 3, b.y - 3, 6, 6, player.x - player.w / 2, player.y - player.h / 2, player.w, player.h)) {
              hit = true;
              b.dead = true;
            }
          });
          enemyBullets = enemyBullets.filter(b => !b.dead);

          enemies.forEach(e => {
            if (rectHit(e.x - e.w / 2, e.y - e.h / 2, e.w, e.h, player.x - player.w / 2, player.y - player.h / 2, player.w, player.h)) {
              hit = true;
              e.dead = true;
            }
          });
          enemies = enemies.filter(e => !e.dead);

          if (hit) {
            lives -= 1;
            livesEl.textContent = lives.toString();
            player.invincibleTime = 2;
            statusText.textContent = "Hit! You are briefly invincible.";
            statusText.className = "status-text bad";
            if (lives <= 0) {
              endRun();
            }
          }
        }
      }

      function rectHit(x1, y1, w1, h1, x2, y2, w2, h2) {
        return !(
          x1 + w1 < x2 ||
          x1 > x2 + w2 ||
          y1 + h1 < y2 ||
          y1 > y2 + h2
        );
      }

      function draw() {
        // background
        ctx.fillStyle = "#020617";
        ctx.fillRect(0, 0, WIDTH, HEIGHT);

        // parallax stripes
        ctx.strokeStyle = "#0b1220";
        ctx.lineWidth = 1;
        for (let y = 0; y < HEIGHT; y += 24) {
          ctx.beginPath();
          ctx.moveTo(0, y + (performance.now() / 40 % 24));
          ctx.lineTo(WIDTH, y + (performance.now() / 40 % 24));
          ctx.stroke();
        }

        // stars
        stars.forEach(s => {
          ctx.fillStyle = s.r > 2 ? "#facc15" : "#64748b";
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
          ctx.fill();
        });

        // player plane (pixel-ish)
        const p = player;
        const flicker = player.invincibleTime > 0 && Math.floor(player.invincibleTime * 20) % 2 === 0;
        if (!flicker) {
          ctx.save();
          ctx.translate(p.x, p.y);
          // body
          ctx.fillStyle = "#38bdf8";
          ctx.fillRect(-3, -10, 6, 20);
          // wings
          ctx.fillStyle = "#1d4ed8";
          ctx.fillRect(-11, -2, 22, 4);
          // nose
          ctx.fillStyle = "#f97316";
          ctx.fillRect(-2, -12, 4, 4);
          ctx.restore();
        }

        // bullets
        ctx.fillStyle = "#e5e7eb";
        bullets.forEach(b => {
          ctx.fillRect(b.x - 2, b.y - 6, 4, 12);
        });

        // enemies
        enemies.forEach(e => {
          ctx.save();
          ctx.translate(e.x, e.y);
          ctx.fillStyle = "#f97316";
          ctx.fillRect(-8, -8, 16, 16);
          ctx.fillStyle = "#b91c1c";
          ctx.fillRect(-10, -2, 20, 4);
          ctx.restore();
        });

        // enemy bullets
        ctx.fillStyle = "#fb7185";
        enemyBullets.forEach(b => {
          ctx.fillRect(b.x - 2, b.y - 4, 4, 8);
        });
      }

      function loop(timestamp) {
        const dt = Math.min((timestamp - lastTime) / 1000, 0.05);
        lastTime = timestamp;
        update(dt);
        draw();
        if (running) {
          requestAnimationFrame(loop);
        }
      }

      function endRun() {
        running = false;
        statusText.textContent = "Run over – press New Run to play again.";
        statusText.className = "status-text bad";
        if (score > bestScore) {
          bestScore = score;
          bestEl.textContent = bestScore.toString();
          localStorage.setItem(BEST_KEY, bestScore);
          statusText.textContent = "New best score! Press New Run to go again.";
          statusText.className = "status-text good";
        }
      }

      // Input handling
      window.addEventListener("keydown", (e) => {
        const k = e.key;
        if (["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"," ","j","J","w","W","a","A","s","S","d","D"].includes(k)) {
          e.preventDefault();
        }
        if (k === "ArrowLeft" || k === "a" || k === "A") keys.left = true;
        if (k === "ArrowRight" || k === "d" || k === "D") keys.right = true;
        if (k === "ArrowUp" || k === "w" || k === "W") keys.up = true;
        if (k === "ArrowDown" || k === "s" || k === "S") keys.down = true;
        if (k === " " || k === "j" || k === "J") keys.shoot = true;
      });

      window.addEventListener("keyup", (e) => {
        const k = e.key;
        if (k === "ArrowLeft" || k === "a" || k === "A") keys.left = false;
        if (k === "ArrowRight" || k === "d" || k === "D") keys.right = false;
        if (k === "ArrowUp" || k === "w" || k === "W") keys.up = false;
        if (k === "ArrowDown" || k === "s" || k === "S") keys.down = false;
        if (k === " " || k === "j" || k === "J") keys.shoot = false;
      });

      // Touch shooting (tap anywhere on board)
      boardWrapper.addEventListener("touchstart", (e) => {
        e.preventDefault();
        keys.shoot = true;
        setTimeout(() => { keys.shoot = false; }, 120);
      }, { passive: false });

      restartBtn.addEventListener("click", resetGame);

      // Start
      resetGame();
    })();
  </script>
</body>
</html>
